---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PostCard from '../../components/PostCard.astro';
import { getAllTags, getPublishedPosts } from '../../utils/content';

export async function getStaticPaths() {
  const tags = await getAllTags();
  return tags.map((tag) => ({
    params: { tag: tag.slug },
    props: { tag },
  }));
}

const { tag } = Astro.props;
const posts = (await getPublishedPosts()).filter((post) =>
  post.data.tagSlugs.includes(tag.slug),
);
---

<BaseLayout title={`标签 · ${tag.label}`}>
  <section class="space-y-4">
    <h1 class="text-2xl font-semibold">标签：{tag.label}</h1>
    <div class="space-y-4">
      {posts.map((post) => (
        <PostCard post={post} />
      ))}
    </div>
  </section>
</BaseLayout>
